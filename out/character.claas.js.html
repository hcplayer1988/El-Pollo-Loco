<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: character.claas.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: character.claas.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Represents the main playable character in the game.
 * Handles movement, animation, sound effects, and interaction with the game world.
 * Inherits from MovableObject.
 */
class Character extends MovableObject {
    /** @type {string[]} Animation frames for walking */
    images_walking = [
        'assets/img/ingame_imgs/2.character.pepe/2.walk/W-21.png',
        'assets/img/ingame_imgs/2.character.pepe/2.walk/W-22.png',
        'assets/img/ingame_imgs/2.character.pepe/2.walk/W-23.png',
        'assets/img/ingame_imgs/2.character.pepe/2.walk/W-24.png',
        'assets/img/ingame_imgs/2.character.pepe/2.walk/W-25.png',
        'assets/img/ingame_imgs/2.character.pepe/2.walk/W-26.png'
    ];
    /** @type {string[]} Animation frames for jumping */
    images_jumping = [
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-31.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-32.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-33.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-34.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-35.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-36.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-37.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-38.png',
        'assets/img/ingame_imgs/2.character.pepe/3.jump/J-39.png'
    ];
    /** @type {string[]} Animation frames for death */
    images_dead = [
        'assets/img/ingame_imgs/2.character.pepe/5.dead/D-51.png',
        'assets/img/ingame_imgs/2.character.pepe/5.dead/D-52.png',
        'assets/img/ingame_imgs/2.character.pepe/5.dead/D-53.png',
        'assets/img/ingame_imgs/2.character.pepe/5.dead/D-54.png',
        'assets/img/ingame_imgs/2.character.pepe/5.dead/D-55.png',
        'assets/img/ingame_imgs/2.character.pepe/5.dead/D-56.png',
        'assets/img/ingame_imgs/2.character.pepe/5.dead/D-57.png'
    ];
    /** @type {string[]} Animation frames for hurt */
    images_hurt = [
        'assets/img/ingame_imgs/2.character.pepe/4.hurt/H-41.png',
        'assets/img/ingame_imgs/2.character.pepe/4.hurt/H-42.png',
        'assets/img/ingame_imgs/2.character.pepe/4.hurt/H-43.png'
    ];
    /** @type {string[]} Animation frames for idle */
    images_idle = [
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-1.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-2.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-3.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-4.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-5.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-6.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-7.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-8.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-9.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-10.png'
    ];
    /** @type {string[]} Animation frames for long idle */
    images_idle_long = [
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-11.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-12.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-13.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-14.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-15.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-16.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-17.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-18.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-19.png',
        'assets/img/ingame_imgs/2.character.pepe/1.idle/long_idle/I-20.png'
    ];
    /** @type {HTMLAudioElement} Sound for walking */
    walking_sound = new Audio('audio/fast_walk_sand.mp3');
    /** @type {HTMLAudioElement} Sound for jumping */
    jump_sound = new Audio('audio/jump.mp3');
    /** @type {HTMLAudioElement} Sound for snoring during long idle */
    snoring_sound = new Audio('audio/snoring.mp3');
    /** @type {HTMLAudioElement} Sound for getting hit */
    hit_sound = new Audio('audio/hit_sound.mp3');
    /** @type {number} Index of the current animation frame */
    currentImage = 0;
    /** @type {World} Reference to the game world */
    world;
    /** @type {number} Movement speed of the character */
    speed = 4;
    /** @type {number|null} Last bottom position before getting hit */
    lastBottomBeforeHit = null;
    /**
     * @type {{top: number, left: number, right: number, bottom: number}}
     * Collision offset values for the character
     */
    offset = {
        top: 50,
        left: 10,
        right: 10,
        bottom: 6
    };
    /** @type {number[]} Array of interval IDs for animation loops */
    characterIntervals = [];

    /**
     * Creates a new Character instance.
     * Loads all animation images, applies gravity, and registers sounds.
     */
    constructor() {
        super().loadImage('assets/img/ingame_imgs/2.character.pepe/1.idle/idle/I-1.png')
        this.loadImages(this.images_walking);
        this.loadImages(this.images_jumping);
        this.loadImages(this.images_dead);
        this.loadImages(this.images_hurt);
        this.loadImages(this.images_idle);
        this.loadImages(this.images_idle_long);
        this.applyGravity();
        this.idleLongPlayed = false;
        this.idleLongStartTime = null;
        this.defaultX = this.x;
        this.defaultY = this.y;
        this.defaultSpeed = this.speed;
        soundhub.addSound(this.walking_sound);
        soundhub.addSound(this.jump_sound);
        soundhub.addSound(this.snoring_sound);
        soundhub.addSound(this.hit_sound);
    }

    /**
     * Starts animation loops for movement, action, and idle behavior.
     * Uses multiple intervals to handle different animation states.
    */
    animate() {
        this.characterIntervals.push(setInterval(() => {
            this.handleMovement();
            this.updateCamera();
            this.resetIdleTimerIfActive();
        }, 1000 / 60));

        this.characterIntervals.push(setInterval(() => {
            this.handleHurtOrDeathAnimation() || this.handleMovementAnimation();
        }, 1000 / 25));

        this.characterIntervals.push(setInterval(() => {
            this.handleIdleAnimation();
        }, 1000 / 10));
    }

    /**
     * Stops all animation intervals and clears the interval list.
     */
    stopAnimation() {
        this.characterIntervals.forEach(clearInterval);
        this.characterIntervals = [];
    }

    /**
     * Handles character movement based on keyboard input.
     * Updates position and triggers movement sounds.
     */
    handleMovement() {
        if (this.world?.gameStopped) return;
        this.lastBottomBeforeHit = this.y + this.height;
        this.walking_sound.pause();
        this.actionOccurred = false;
        this.handleRightMovement();
        this.handleLeftMovement();
        this.handleJump();
    }

    /**
     * Moves the character to the right if the right key is pressed.
     * Plays walking sound and sets direction.
     */
    handleRightMovement() {
        if (this.world.keyboard.d_right &amp;&amp; this.x &lt; this.world.level.level_end_x) {
            this.moveRight();
            this.otherDirection = false;
            this.walking_sound.play();
            this.actionOccurred = true;
        }
    }

    /**
     * Moves the character to the left if the left key is pressed.
     * Plays walking sound and sets direction.
     */
    handleLeftMovement() {
        if (this.world.keyboard.a_left &amp;&amp; this.x > -600) {
            this.moveLeft();
            this.otherDirection = true;
            this.walking_sound.play();
            this.actionOccurred = true;
        }
    }

    /**
     * Makes the character jump if the jump key is pressed and character is on the ground.
     * Plays jump sound and triggers jump animation.
     */
    handleJump() {
        if (this.world.keyboard.w_jump &amp;&amp; !this.isAboveGround()) {
            this.jump_sound.currentTime = 0;
            this.jump_sound.play();
            this.jump();
            this.actionOccurred = true;
        }
    }

    /**
     * Updates the camera position based on character's x-coordinate.
     */
    updateCamera() {
        this.world.camera_x = -this.x + 100;
    }

    /**
     * Resets the idle timer if any action occurred or character is hurt/dead.
     * Stops snoring sound and resets idle state.
     */
    resetIdleTimerIfActive() {
        if (this.actionOccurred || this.hurtAnimationTriggered || this.isDead()) {
            this.lastActionTime = Date.now();
            this.idleLongPlayed = false;
            this.idleLongStartTime = null;
            this.snoring_sound.pause();
        }
    }

    /**
     * Handles animation updates based on character state.
     * Prioritizes hurt/death, then movement, then idle.
     */
    handleAnimation() {
        this.handleHurtOrDeathAnimation() ||
        this.handleMovementAnimation() ||
        this.handleIdleAnimation();
        if (!this.world || !this.world.gameStarted || this.world.gameStopped) {
            return;
        }
    }

    /**
     * Stops all character-related sounds.
     */
    stopAllSounds() {
        this.walking_sound.pause();
        this.jump_sound.pause();
        this.snoring_sound.pause();
        this.hit_sound.pause();
    }

    /**
     * Plays hurt or death animation depending on character state.
     * @returns {boolean} True if an animation was played.
     */
    handleHurtOrDeathAnimation() {
        if (this.hurtAnimationTriggered) {
            this.hit_sound.play();
            this.playAnimation(this.images_hurt);
            return true;
        }
        if (this.isDead()) {
            this.playAnimation(this.images_dead);
            return true;
        }
        return false;
    }

    /**
     * Plays movement animation if character is jumping or walking.
     * @returns {boolean} True if an animation was played.
     */
    handleMovementAnimation() {
        if (this.isAboveGround()) {
            this.playAnimation(this.images_jumping);
            return true;
        }
        if (this.world.keyboard.d_right || this.world.keyboard.a_left) {
            this.playAnimation(this.images_walking);
            return true;
        }
        return false;
    }

    /**
     * Plays idle or long idle animation depending on inactivity duration.
     * Triggers snoring sound during long idle.
     */
    handleIdleAnimation() {
        if (!this.world || !this.world.gameStarted) {
            return;
        }
        let now = Date.now();
        let inactiveTime = now - this.lastActionTime;
        if (inactiveTime > 10000 || this.idleLongPlayed) {
            this.snoring_sound.loop = true;
            this.snoring_sound.play();
            this.playAnimation(this.images_idle_long);
            this.idleLongPlayed = true;
        } else {
            this.playAnimation(this.images_idle);
        }
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Character.html">Character</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Mon Aug 11 2025 14:31:33 GMT+0200 (Mitteleurop√§ische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
